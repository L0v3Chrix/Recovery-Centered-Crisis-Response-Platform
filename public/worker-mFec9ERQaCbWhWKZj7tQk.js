self.addEventListener("fetch",e=>{const{request:t}=e,s=new URL(t.url);if("https:"!==s.protocol&&!s.hostname.includes("localhost")&&!s.hostname.includes("127.0.0.1"))return console.warn(`Blocked non-HTTPS request: ${s.href}`),void e.respondWith(new Response("HTTPS required",{status:403,statusText:"Forbidden",headers:{"Content-Type":"text/plain"}}))}),self.addEventListener("fetch",e=>{e.respondWith(fetch(e.request).then(e=>{const t=new Response(e.body,e);return t.headers.set("Content-Security-Policy","upgrade-insecure-requests"),t.headers.set("X-Content-Type-Options","nosniff"),t.headers.set("Referrer-Policy","strict-origin-when-cross-origin"),t}).catch(e=>{throw console.error("Fetch failed:",e),e}))});